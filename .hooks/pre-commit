#!/bin/sh
# SPDX-License-Identifier: AGPL-3.0-or-later
#
# Stagecraft - A Go-based CLI for orchestrating local-first multi-service deployments using Docker Compose.
#
# Copyright (C) 2025  Bartek Kus
#
# This program is free software licensed under the terms of the GNU AGPL v3 or later.
#
# See https://www.gnu.org/licenses/ for license details.
#
# Pre-commit hook to enforce license headers

set -e

echo "Running license header check..."

# Check if addlicense is installed
if ! command -v addlicense >/dev/null 2>&1; then
	echo "Warning: addlicense not found. Install with: go install github.com/google/addlicense@latest"
	echo "Skipping license check."
	exit 0
fi

# Run addlicense check
if ! addlicense -check .; then
	echo ""
	echo "ERROR: Missing or incorrect license headers detected."
	echo ""
	echo "To fix, run:"
	echo "  addlicense -c 'Bartek Kus' -l agpl -y 2025 ."
	echo ""
	echo "Or use the helper script:"
	echo "  ./scripts/add-headers.sh"
	echo ""
	exit 1
fi

echo "âœ“ License headers OK"
